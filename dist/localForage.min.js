/*!
 localForage
 (c) 2013-2014 Mozilla
 License: Apache License
 */// ES6 Promises Polyfill
// https://github.com/jakearchibald/ES6-Promises
// MIT license
// (https://github.com/jakearchibald/ES6-Promises/blob/master/LICENSE)
(function(){var a,b,c,d;(function(){var e={},f={};a=function(a,b,c){e[a]={deps:b,callback:c}},d=c=b=function(a){function n(b){if(b.charAt(0)!==".")return b;var c=b.split("/"),d=a.split("/").slice(0,-1);for(var e=0,f=c.length;e<f;e++){var g=c[e];if(g==="..")d.pop();else{if(g===".")continue;d.push(g)}}return d.join("/")}d._eak_seen=e;if(f[a])return f[a];f[a]={};if(!e[a])throw new Error("Could not find module "+a);var c=e[a],g=c.deps,h=c.callback,i=[],j;for(var k=0,l=g.length;k<l;k++)g[k]==="exports"?i.push(j={}):i.push(b(n(g[k])));var m=h.apply(this,i);return f[a]=j||m}})(),a("promise/all",["./utils","exports"],function(a,b){function e(a){var b=this;if(!c(a))throw new TypeError("You must pass an array to all.");return new b(function(b,c){function i(a,c){e[a]=c,--f===0&&b(e)}function h(a){return function(b){i(a,b)}}var e=[],f=a.length,g;f===0&&b([]);for(var j=0;j<a.length;j++)g=a[j],g&&d(g.then)?g.then(h(j),c):i(j,g)})}"use strict";var c=a.isArray,d=a.isFunction;b.all=e}),a("promise/asap",["exports"],function(a){function k(a,b){var c=h.push([a,b]);c===1&&j()}function i(){for(var a=0;a<h.length;a++){var b=h[a],c=b[0],d=b[1];c(d)}h=[]}function g(){return function(){d.setTimeout(i,1)}}function f(){var a=0,b=new c(i),d=document.createTextNode("");b.observe(d,{characterData:!0});return function(){d.data=a=++a%2}}function e(){return function(){process.nextTick(i)}}"use strict";var b=typeof window!="undefined"?window:{},c=b.MutationObserver||b.WebKitMutationObserver,d=typeof global!="undefined"?global:this,h=[],j;typeof process!="undefined"&&{}.toString.call(process)==="[object process]"?j=e():c?j=f():j=g(),a.asap=k}),a("promise/cast",["exports"],function(a){function b(a){if(a&&typeof a=="object"&&a.constructor===this)return a;var b=this;return new b(function(b){b(a)})}"use strict",a.cast=b}),a("promise/config",["exports"],function(a){function c(a,c){if(arguments.length===2)b[a]=c;else return b[a]}"use strict";var b={instrument:!1};a.config=b,a.configure=c}),a("promise/polyfill",["./promise","./utils","exports"],function(a,b,c){function f(){var a="Promise"in window&&"cast"in window.Promise&&"resolve"in window.Promise&&"reject"in window.Promise&&"all"in window.Promise&&"race"in window.Promise&&function(){var a;new window.Promise(function(b){a=b});return e(a)}();a||(window.Promise=d)}"use strict";var d=a.Promise,e=b.isFunction;c.polyfill=f}),a("promise/promise",["./config","./utils","./cast","./all","./race","./resolve","./reject","./asap","exports"],function(a,b,c,d,e,f,g,h,i){function J(a){D(a,a._state=B)}function I(a){D(a,a._state=A)}function H(a,b){a._state===y&&(a._state=z,a._detail=b,j.async(J,a))}function G(a,b){a._state===y&&(a._state=z,a._detail=b,j.async(I,a))}function F(a,b){a===b?G(a,b):E(a,b)||G(a,b)}function E(a,b){var c=null,d;try{if(a===b)throw new TypeError("A promises callback cannot return that same promise.");if(l(b)){c=b.then;if(m(c)){c.call(b,function(c){if(d)return!0;d=!0,b!==c?F(a,c):G(a,c)},function(b){if(d)return!0;d=!0,H(a,b)});return!0}}}catch(e){if(d)return!0;H(a,e);return!0}return!1}function D(a,b){var c,d,e=a._subscribers,f=a._detail;for(var g=0;g<e.length;g+=3)c=e[g],d=e[g+b],x(b,c,d,f);a._subscribers=null}function C(a,b,c,d){var e=a._subscribers,f=e.length;e[f]=b,e[f+A]=c,e[f+B]=d}function x(a,b,c,d){var e=m(c),f,g,h,i;if(e)try{f=c(d),h=!0}catch(j){i=!0,g=j}else f=d,h=!0;E(b,f)||(e&&h?F(b,f):i?H(b,g):a===A?F(b,f):a===B&&H(b,f))}function w(a,b){function d(a){H(b,a)}function c(a){F(b,a)}try{a(c,d)}catch(e){d(e)}}function v(a){if(!m(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(this instanceof v)this._subscribers=[],w(a,this);else throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}"use strict";var j=a.config,k=a.configure,l=b.objectOrFunction,m=b.isFunction,n=b.now,o=c.cast,p=d.all,q=e.race,r=f.resolve,s=g.reject,t=h.asap,u=0;j.async=t;var y=void 0,z=0,A=1,B=2;v.prototype={constructor:v,_state:undefined,_detail:undefined,_subscribers:undefined,then:function(a,b){var c=this,d=new this.constructor(function(){});if(this._state){var e=arguments;j.async(function(){x(c._state,d,e[c._state-1],c._detail)})}else C(this,d,a,b);return d},"catch":function(a){return this.then(null,a)}},v.all=p,v.cast=o,v.race=q,v.resolve=r,v.reject=s,i.Promise=v}),a("promise/race",["./utils","exports"],function(a,b){function d(a){var b=this;if(!c(a))throw new TypeError("You must pass an array to race.");return new b(function(b,c){var d=[],e;for(var f=0;f<a.length;f++)e=a[f],e&&typeof e.then=="function"?e.then(b,c):b(e)})}"use strict";var c=a.isArray;b.race=d}),a("promise/reject",["exports"],function(a){function b(a){var b=this;return new b(function(b,c){c(a)})}"use strict",a.reject=b}),a("promise/resolve",["exports"],function(a){function b(a){var b=this;return new b(function(b,c){b(a)})}"use strict",a.resolve=b}),a("promise/utils",["exports"],function(a){function d(a){return Object.prototype.toString.call(a)==="[object Array]"}function c(a){return typeof a=="function"}function b(a){return c(a)||typeof a=="object"&&a!==null}"use strict";var e=Date.now||function(){return(new Date).getTime()};a.objectOrFunction=b,a.isFunction=c,a.isArray=d,a.now=e}),b("promise/polyfill").polyfill()})(),function(){function m(a,b){return new d(function(c,d){a<0?(b&&b(null),c(null)):g("readonly",function e(d){var e=!1,f=d.openCursor();f.onsuccess=function(){var d=f.result;d?a===0?(b&&b(d.key),c(d.key)):e?(b&&b(d.key),c(d.key)):(e=!0,d.advance(a)):(b&&b(null),c(null))},f.onerror=function(){console.error("Error in asyncStorage.key(): ",f.error.name)}})})}function l(a){return new d(function(b,c){g("readonly",function d(c){var d=c.count();d.onsuccess=function(){a&&a(d.result),b(d.result)},d.onerror=function(){console.error("Error in asyncStorage.length(): ",d.error.name)}})})}function k(a){return new d(function(b,c){g("readwrite",function d(c){var d=c.clear();d.onsuccess=function(){a&&a(),b()},d.onerror=function(){console.error("Error in asyncStorage.clear(): ",d.error.name)}})})}function j(a,b){return new d(function(c,d){g("readwrite",function e(d){var e=d.delete(a);e.onsuccess=function(){b&&b(),c()},e.onerror=function(){console.error("Error in asyncStorage.removeItem(): ",e.error.name)}})})}function i(a,b,c){return new d(function(d,e){g("readwrite",function f(e){var f=e.put(b,a);f.onsuccess=function(){c&&c(b),d(b)},f.onerror=function(){console.error("Error in asyncStorage.setItem(): ",f.error.name)}})})}function h(a,b){return new d(function(c,d){g("readonly",function e(d){var e=d.get(a);e.onsuccess=function(){var a=e.result;a===undefined&&(a=null),b&&b(a),c(a)},e.onerror=function(){console.error("Error in asyncStorage.getItem(): ",e.error.name)}})})}function g(d,g){if(e)g(e.transaction(c,d).objectStore(c));else{var h=f.open(a,b);h.onerror=function(){console.error("asyncStorage: can't open database:",h.error.name)},h.onupgradeneeded=function(){h.result.createObjectStore(c)},h.onsuccess=function(){e=h.result,g(e.transaction(c,d).objectStore(c))}}}"use strict";var a="asyncStorage",b=1,c="keyvaluepairs",d=window.Promise,e=null,f=f||window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB;if(!!f){var n={driver:"asyncStorage",getItem:h,setItem:i,removeItem:j,clear:k,length:l,key:m};typeof define=="function"&&define.amd?define(function(){return n}):typeof module!="undefined"&&module.exports?module.exports=n:this.asyncStorage=n}}.call(this),function(){function i(a,b){console.error((b||"storage error")+": ",a.error.name)}function h(c,d,e){return new a(function(a,f){try{d=JSON.stringify(d)}catch(g){console.error("Couldn't convert value into a JSON string: ",d),f(g)}b.setItem(c,d),e&&e(d),a(d)})}function g(c,d){return new a(function(a,e){b.removeItem(c),d&&d(),a()})}function f(c){return new a(function(a,d){var e=b.length;c&&c(e),a(e)})}function e(c,d){return new a(function(a,e){var f=b.key(c);d&&d(f),a(f)})}function d(c,d){return new a(function(a,e){try{var f=b.getItem(c);f&&(f=JSON.parse(f)),d&&d(f),a(f)}catch(g){e(g)}})}function c(c){return new a(function(a,d){b.clear(),c&&c(),a()})}"use strict";var a=window.Promise,b;if(!window.chrome||!window.chrome.runtime)b=window.localStorage;var j={driver:"localStorageWrapper",getItem:d,setItem:h,removeItem:g,clear:c,length:f,key:e,get:d,set:h,remove:g,removeAll:c};typeof define=="function"&&define.amd?define(function(){return j}):typeof module!="undefined"&&module.exports?module.exports=j:this.localStorageWrapper=j}.call(this),function(){function l(a,b){return new e(function(c,d){f.transaction(function(d){d.executeSql("SELECT * FROM localforage WHERE id = ? LIMIT 1",[a],function(a,d){var e=d.rows.length?d.rows.item(0).value:undefined;b&&b(e),c(e)},null)})})}function k(a){return new e(function(b,c){f.transaction(function(c){c.executeSql("SELECT COUNT(key) FROM localforage",[],function(c,d){var e=d.rows.length;a&&a(e),b(e)},null)})})}function j(a){return new e(function(b,c){f.transaction(function(c){c.executeSql("TRUNCATE localforage",[l],function(){a&&a(),b()},null)})})}function i(a,b){return new e(function(c,d){f.transaction(function(d){d.executeSql("DELETE FROM localforage WHERE key = ? LIMIT 1",[a],function(){b&&b(),c()},null)})})}function h(a,b,c){return new e(function(d,e){f.transaction(function(e){e.executeSql("INSERT OR REPLACE INTO localforage (key, value) VALUES (?, ?)",[a,b],function(){c&&c(b),d(b)},null)})})}function g(a,b){return new e(function(a,c){f.transaction(function(c){c.executeSql("SELECT * FROM localforage LIMIT 1",[],function(c,d){var e=d.rows.item(0);b&&b(e.value),a(e.value)},null)})})}"use strict";var a="localforage",b=5242880,c="1.0",d="keyvaluepairs",e=window.Promise;if(!!window.openDatabase){var f=window.openDatabase(a,c,d,b);f.transaction(function(a){a.executeSql("CREATE TABLE IF NOT EXISTS localforage (id INTEGER PRIMARY KEY, key unique, value)")});var m={driver:"webSQLStorage",getItem:g,setItem:h,removeItem:i,clear:j,length:k,key:l};typeof define=="function"&&define.amd?define(function(){return m}):typeof module!="undefined"&&module.exports?module.exports=m:this.webSQLStorage=m}}.call(this),function(){"use strict";var a=a||window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB,b;a&&!window._FORCE_LOCALSTORAGE?b="asyncStorage":window.openDatabase&&!window._FORCE_LOCALSTORAGE?b="webSQLStorage":b="localStorageWrapper";if(typeof define=="function"&&define.amd)define([b],function(a){return a});else if(typeof module!="undefined"&&module.exports){var c=require("./"+b);module.exports=c}else this.localForage=this[b]}.call(this)