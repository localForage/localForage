
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

    <!-- Use title if it's in the page YAML frontmatter -->
    <title>localForage API Reference</title>

    <link href="stylesheets/screen.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="stylesheets/print.css" media="print" rel="stylesheet" type="text/css" />
    <script src="//code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="javascripts/all.js" type="text/javascript"></script>

    <script>
      $(function() {
        var toc = $("#toc").tocify({
          selectors: "h1,h2",
          extendPage: false,
          theme: "none",
          smoothScroll: false,
          showEffectSpeed: 0,
          hideEffectSpeed: 180,
          ignoreSelector: ".toc-ignore",
          hashGenerator: 'pretty',
          highlightOffset: 60,
          scrollTo: -2,
          scrollHistory: true,
          hashGenerator: function(text, element) {
            return element[0].getAttribute('id');
          }
        }).data("toc-tocify");
        // Hack to make already open sections to start opened,
        // instead of displaying an ugly animation
        setTimeout(function() {
          toc.setOption("showEffectSpeed", 180);
        },50);
        setupLanguages([
          
            
              
                'javascript',
              
            
              
                'coffeescript',
              
            
          
        ]);
      });
    </script>
  </head>

  <body class="index">
    <div class="tocify-wrapper">
      <a href="https://mozilla.org/" id="logo">
        <img alt="Mozilla" src="images/logo.png" />
      </a>
      <div id="toc">
      </div>
      
      <ul class="toc-footer">
        
          <li><a href="https://github.com/mozilla/localForage">Contribute to localForage</a></li>
        
          <li><a href="https://github.com/tripit/slate">(Docs Powered by Slate)</a></li>
        
      </ul>
      

      <div class="build-status">
        <a href="http://travis-ci.org/mozilla/localForage"><img src="https://secure.travis-ci.org/mozilla/localForage.png?branch=master" alt="Build Status"></a>
      </div>
    </div>
    <div class="page-wrapper">
      <div class="content">
        <h1 id="localforage">localForage</h1>
<pre class="highlight javascript"><code><span class="c1">// In localStorage, we would do:</span>
<span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="s1">'value'</span><span class="p">));</span>
<span class="nx">doSomethingElse</span><span class="p">();</span>

<span class="c1">// With localForage, we use callbacks:</span>
<span class="nx">localforage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">,</span> <span class="nx">doSomethingElse</span><span class="p">);</span>

<span class="c1">// Or we can use Promises:</span>
<span class="nx">localforage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="s1">'value'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">doSomethingElse</span><span class="p">);</span>
</code></pre>
<pre class="highlight coffeescript"><code><span class="c1"># In localStorage, we would do:
</span><span class="nx">localStorage</span><span class="p">.</span><span class="na">setItem</span> <span class="s">"key"</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="na">stringify</span><span class="p">(</span><span class="s">"value"</span><span class="p">)</span>
<span class="nx">doSomethingElse</span><span class="p">()</span>

<span class="c1"># With localForage, we use callbacks:
</span><span class="nx">localforage</span><span class="p">.</span><span class="na">setItem</span> <span class="s">"key"</span><span class="p">,</span> <span class="s">"value"</span><span class="p">,</span> <span class="nx">doSomethingElse</span>

<span class="c1"># Or we can use Promises:
</span><span class="nx">localforage</span><span class="p">.</span><span class="na">setItem</span><span class="p">(</span><span class="s">"key"</span><span class="p">,</span> <span class="s">"value"</span><span class="p">).</span><span class="na">then</span> <span class="nx">doSomethingElse</span>
</code></pre>

<p><strong>Offline storage, improved.</strong></p>

<p>localForage is a JavaScript library that improves the offline experience of
your web app by using an asynchronous data store with a simple,
<code class="prettyprint">localStorage</code>-like API. It allows developers to
<a href="#setitem">store many types of data</a> instead of just strings.</p>

<p>localForage includes a localStorage-backed fallback store for browsers with no
IndexedDB or WebSQL support. Asynchronous storage is available in the current
versions of all major browsers: Chrome, Firefox, IE, and Safari
(including Safari Mobile).</p>

<p><strong>localForage offers a callback API as well as support for the
<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise">ES6 Promises API</a></strong>, so you can use whichever you prefer.</p>

<p><a href="https://mozilla.github.io/localForage/localforage.min.js">Download localforage.min.js</a></p>

<h1 id="installation">Installation</h1>
<pre class="highlight shell"><code><span class="c"># Install via npm:</span>
npm install localforage

<span class="c"># Or with bower:</span>
bower install localforage
</code></pre>
<pre class="highlight html"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"localforage.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="nx">localforage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">'somekey'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">});</span><span class="nt">&lt;/script&gt;</span>
</code></pre>

<p>To use localForage, <a href="https://github.com/mozilla/localForage/releases">download the latest release</a> or install with <a href="https://www.npmjs.org/">npm</a> (<code class="prettyprint">npm install localforage</code>) or <a href="http://bower.io/">bower</a> (<code class="prettyprint">bower install localforage</code>).</p>

<p>Then simply include the JS file and start using localForage:
<code class="prettyprint">&lt;script src=&quot;localforage.js&quot;&gt;&lt;/script&gt;</code>. You don&rsquo;t need to run any init method
or wait for any <code class="prettyprint">onready</code> events.</p>

<h1 id="data-api">Data API</h1>

<p>These APIs deal with getting and setting data in the offline store.</p>

<h2 id="getitem">getItem</h2>
<pre class="highlight javascript"><code><span class="nx">localforage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">'somekey'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Run this code once the value has been</span>
    <span class="c1">// loaded from the offline store.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">localforage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">'somekey'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// The same code, but using ES6 Promises.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight coffeescript"><code><span class="nx">localforage</span><span class="p">.</span><span class="na">getItem</span> <span class="s">"somekey"</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="c1"># Run this code once the value has been loaded
</span>  <span class="c1"># from the offline store.
</span>  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="nx">value</span>

<span class="nx">localforage</span><span class="p">.</span><span class="na">getItem</span><span class="p">(</span><span class="s">"somekey"</span><span class="p">).</span><span class="na">then</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="c1"># The same code, but using ES6 Promises.
</span>  <span class="nx">console</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>
</code></pre>

<p><code class="prettyprint">getItem(key, successCallback)</code></p>

<p>Gets an item from the storage library and supplies the result to a callback.
If the key does not exist, <code class="prettyprint">getItem()</code> will return <code class="prettyprint">null</code>.</p>

<p><aside class="notice">
  Even if <code class="prettyprint">undefined</code> is saved, <code class="prettyprint">null</code> will be returned by <code class="prettyprint">getItem()</code>. This
  is due to a
  <a href="https://github.com/mozilla/localForage/pull/42">limitation in localStorage</a>,
  and for compatibility reasons localForage cannot store the value <code class="prettyprint">undefined</code>.
</aside></p>

<h2 id="setitem">setItem</h2>
<pre class="highlight javascript"><code><span class="nx">localforage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">'somekey'</span><span class="p">,</span> <span class="s1">'some value'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Do other things once the value has been saved.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// Unlike localStorage, you can store non-strings.</span>
<span class="nx">localforage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">'my array'</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'three'</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// This will output `1`.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">});</span>

<span class="c1">// You can even store binary data from an AJAX request.</span>
<span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">'GET'</span><span class="p">,</span> <span class="s1">'/photo.jpg'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">responseType</span> <span class="o">=</span> <span class="s1">'arraybuffer'</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'readystatechange'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">===</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// readyState DONE</span>
        <span class="nx">localforage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">'photo'</span><span class="p">,</span> <span class="nx">request</span><span class="p">.</span><span class="nx">response</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">img</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// This will be a valid blob URI for an &lt;img&gt; tag.</span>
            <span class="kd">var</span> <span class="nx">blob</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Blob</span><span class="p">([</span><span class="nx">image</span><span class="p">]);</span>
            <span class="kd">var</span> <span class="nx">imageURI</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">URL</span><span class="p">.</span><span class="nx">createObjectURL</span><span class="p">(</span><span class="nx">blob</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight coffeescript"><code><span class="nx">localforage</span><span class="p">.</span><span class="na">setItem</span> <span class="s">"somekey"</span><span class="p">,</span> <span class="s">"some value"</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="c1"># Do other things once the value has been saved.
</span>  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="nx">value</span>

<span class="c1"># Unlike localStorage, you can store non-strings.
</span><span class="nx">localforage</span><span class="p">.</span><span class="na">setItem</span> <span class="s">"my array"</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s">"three"</span><span class="p">],</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="c1"># This will output `1`.
</span>  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="nx">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># You can even store binary data from an AJAX request.
</span><span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">()</span>
<span class="nx">request</span><span class="p">.</span><span class="na">open</span> <span class="s">"GET"</span><span class="p">,</span> <span class="s">"photo.jpg"</span><span class="p">,</span> <span class="no">true</span>
<span class="nx">request</span><span class="p">.</span><span class="na">responseType</span> <span class="o">=</span> <span class="s">"arraybuffer"</span>

<span class="nx">request</span><span class="p">.</span><span class="na">addEventListener</span> <span class="s">"readystatechange"</span><span class="p">,</span> <span class="o">-&gt;</span>
  <span class="k">if</span> <span class="nx">request</span><span class="p">.</span><span class="na">readyState</span> <span class="o">==</span> <span class="mi">4</span> <span class="c1"># readyState DONE
</span>    <span class="nx">localforage</span><span class="p">.</span><span class="na">setItem</span> <span class="s">"photo"</span><span class="p">,</span> <span class="nx">request</span><span class="p">.</span><span class="na">response</span><span class="p">,</span> <span class="p">(</span><span class="nx">img</span><span class="p">)</span> <span class="o">-&gt;</span>
      <span class="c1"># This will be a valid blob URI for an &lt;img&gt; tag.
</span>      <span class="nx">blob</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Blob</span> <span class="p">[</span><span class="nx">image</span><span class="p">]</span>
      <span class="nx">imageURI</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="na">URL</span><span class="p">.</span><span class="na">createObjectURL</span> <span class="nx">blob</span>
</code></pre>

<p><code class="prettyprint">setItem(key, value, successCallback)</code></p>

<p>Saves data to an offline store. You can store the following types of JavaScript
objects:</p>

<ul>
<li><strong><code class="prettyprint">Array</code></strong></li>
<li><strong><code class="prettyprint">ArrayBuffer</code></strong></li>
<li><strong><code class="prettyprint">Blob</code></strong></li>
<li><strong><code class="prettyprint">Float32Array</code></strong></li>
<li><strong><code class="prettyprint">Float64Array</code></strong></li>
<li><strong><code class="prettyprint">Int8Array</code></strong></li>
<li><strong><code class="prettyprint">Int16Array</code></strong></li>
<li><strong><code class="prettyprint">Int32Array</code></strong></li>
<li><strong><code class="prettyprint">Number</code></strong></li>
<li><strong><code class="prettyprint">Object</code></strong></li>
<li><strong><code class="prettyprint">Uint8Array</code></strong></li>
<li><strong><code class="prettyprint">Uint8ClampedArray</code></strong></li>
<li><strong><code class="prettyprint">Uint16Array</code></strong></li>
<li><strong><code class="prettyprint">Uint32Array</code></strong></li>
<li><strong><code class="prettyprint">String</code></strong></li>
</ul>

<p><aside class="notice">
  When using localStorage and WebSQL backends, binary data will be serialized
  before being saved (and retrieved). This serialization will incur a size
  increase when binary data is saved.
</aside></p>

<h2 id="removeitem">removeItem</h2>
<pre class="highlight javascript"><code><span class="nx">localforage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s1">'somekey'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Run this code once the key has been removed.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Key is cleared!'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight coffeescript"><code><span class="nx">localforage</span><span class="p">.</span><span class="na">removeItem</span> <span class="s">"somekey"</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="c1"># Run this code once the key has been removed.
</span>  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="s">"Key is cleared!"</span>
</code></pre>

<p><code class="prettyprint">removeItem(key, successCallback)</code></p>

<p>Removes the value of a key from the offline store.</p>

<h2 id="clear">clear</h2>
<pre class="highlight javascript"><code><span class="nx">localforage</span><span class="p">.</span><span class="nx">clear</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Run this code once the database has been entirely deleted.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Database is now empty.'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight coffeescript"><code><span class="nx">localforage</span><span class="p">.</span><span class="na">clear</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="c1"># Run this code once the database has been entirely deleted.
</span>  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="s">"Database is now empty."</span>
</code></pre>

<p><code class="prettyprint">clear(successCallback)</code></p>

<p>Removes every key from the database, returning it to a blank slate.</p>

<p><aside class="warning">
  <code class="prettyprint">localforage.clear()</code> will remove <strong>every item in the offline store</strong>. Use
  this method with caution.
</aside></p>

<h2 id="length">length</h2>
<pre class="highlight javascript"><code><span class="nx">localforage</span><span class="p">.</span><span class="nx">length</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">numberOfKeys</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Outputs the length of the database.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">numberOfKeys</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight coffeescript"><code><span class="nx">localforage</span><span class="p">.</span><span class="na">length</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">numberOfKeys</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="c1"># Outputs the length of the database.
</span>  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="nx">numberOfKeys</span>
</code></pre>

<p><code class="prettyprint">length(successCallback)</code></p>

<p>Gets the number of keys in the offline store (i.e. its &ldquo;length&rdquo;).</p>

<h2 id="key">key</h2>
<pre class="highlight javascript"><code><span class="nx">localforage</span><span class="p">.</span><span class="nx">key</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">keyName</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Name of the key.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">keyName</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight coffeescript"><code><span class="nx">localforage</span><span class="p">.</span><span class="na">key</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">keyName</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="c1"># Name of the key.
</span>  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="nx">keyName</span>
</code></pre>

<p><code class="prettyprint">key(keyIndex, successCallback)</code></p>

<p>Get the name of a key based on its ID.</p>

<p><aside class="notice">
  This method is inherited from the localStorage API, but is acknowledged to
  be kinda weird.
</aside></p>

<h2 id="keys">keys</h2>
<pre class="highlight javascript"><code><span class="nx">localforage</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">keys</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// An array of all the key names.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">keys</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight coffeescript"><code><span class="nx">localforage</span><span class="p">.</span><span class="na">keys</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">keys</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="c1"># An array of all the key names.
</span>  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="nx">keys</span>
</code></pre>

<p><code class="prettyprint">keys(successCallback)</code></p>

<p>Get the list of all keys in the datastore.</p>

<h2 id="iterate">iterate</h2>
<pre class="highlight javascript"><code><span class="nx">localforage</span><span class="p">.</span><span class="nx">iterate</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iterationNumber</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Resulting key/value pair -- this callback</span>
    <span class="c1">// will be executed for every item in the</span>
    <span class="c1">// database.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]);</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Iteration has completed'</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// The same code, but using ES6 Promises.</span>
<span class="nx">localforage</span><span class="p">.</span><span class="nx">iterate</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iterationNumber</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Resulting key/value pair -- this callback</span>
    <span class="c1">// will be executed for every item in the</span>
    <span class="c1">// database.</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]);</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Iteration has completed'</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// Exit the iteration early:</span>
<span class="nx">localforage</span><span class="p">.</span><span class="nx">iterate</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iterationNumber</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">iterationNumber</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Iteration has completed, last iterated pair:'</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// The same code for early exit, but using ES6 Promises.</span>
<span class="nx">localforage</span><span class="p">.</span><span class="nx">iterate</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iterationNumber</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">iterationNumber</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">([</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Iteration has completed, last iterated pair:'</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight coffeescript"><code><span class="nx">localforage</span><span class="p">.</span><span class="na">iterate</span> <span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iterationNumber</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="c1"># Resulting key/value pair -- this callback
</span>  <span class="c1"># will be executed for every item in the
</span>  <span class="c1"># database.
</span>  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]</span>
  <span class="k">return</span>
<span class="p">,</span> <span class="o">-&gt;</span>
  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="s">"Iteration has completed"</span>

<span class="c1"># The same code, but using ES6 Promises.
</span><span class="nx">localforage</span><span class="p">.</span><span class="na">iterate</span> <span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iterationNumber</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="c1"># Resulting key/value pair -- this callback
</span>  <span class="c1"># will be executed for every item in the
</span>  <span class="c1"># database.
</span>  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]</span>
  <span class="k">return</span>
<span class="p">.</span><span class="na">then</span> <span class="o">-&gt;</span>
  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="s">"Iteration has completed"</span>

<span class="c1"># Exit the iteration early:
</span><span class="nx">localforage</span><span class="p">.</span><span class="na">iterate</span> <span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iterationNumber</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">if</span> <span class="nx">iterationNumber</span> <span class="o">&lt;</span> <span class="mi">3</span>
    <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]</span>
    <span class="k">return</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]</span>
<span class="p">),</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="s">"Iteration has completed, last iterated pair:"</span>
  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="nx">result</span>

<span class="c1"># The same code for early exit, but using ES6 Promises.
</span><span class="nx">localforage</span><span class="p">.</span><span class="na">iterate</span><span class="p">((</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iterationNumber</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="k">if</span> <span class="nx">iterationNumber</span> <span class="o">&lt;</span> <span class="mi">3</span>
    <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]</span>
    <span class="k">return</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]</span>
<span class="p">).</span><span class="na">then</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="s">"Iteration has completed, last iterated pair:"</span>
  <span class="nx">console</span><span class="p">.</span><span class="na">log</span> <span class="nx">result</span>
</code></pre>

<p><code class="prettyprint">iterate(iteratorCallback, successCallback)</code></p>

<p>Iterate over all value/key pairs in datastore.</p>

<p><code class="prettyprint">iteratorCallback</code> is called once for each pair, with the following arguments:</p>

<ol>
<li>value</li>
<li>key</li>
<li>iterationNumber - one-based number</li>
</ol>

<p><aside class="notice">
  <code>iterate</code> supports early exit by returning non <code class="prettyprint">undefined</code>
  value inside <code class="prettyprint">iteratorCallback</code> callback. Resulting value will be passed
  to <code class="prettyprint">successCallback</code> as the result of iteration.</p>

<p>This means if you&rsquo;re using CoffeeScript, you&rsquo;ll need to manually <code class="prettyprint">return</code>
  nothing to keep iterating through each key/value pair.
</aside></p>

<h1 id="settings-api">Settings API</h1>

<p>These methods allow driver selection and database configuration. These methods
should generally be called before the first <em>data</em> API call to localForage (
i.e. before you call <code class="prettyprint">getItem()</code> or <code class="prettyprint">length()</code>, etc.)</p>

<h2 id="setdriver">setDriver</h2>
<pre class="highlight javascript"><code><span class="c1">// Force localStorage to be the backend driver.</span>
<span class="nx">localforage</span><span class="p">.</span><span class="nx">setDriver</span><span class="p">(</span><span class="nx">localforage</span><span class="p">.</span><span class="nx">LOCALSTORAGE</span><span class="p">);</span>

<span class="c1">// Supply a list of drivers, in order of preference.</span>
<span class="nx">localforage</span><span class="p">.</span><span class="nx">setDriver</span><span class="p">([</span><span class="nx">localforage</span><span class="p">.</span><span class="nx">WEBSQL</span><span class="p">,</span> <span class="nx">localforage</span><span class="p">.</span><span class="nx">INDEXEDDB</span><span class="p">]);</span>
</code></pre>
<pre class="highlight coffeescript"><code><span class="c1"># Force localStorage to be the backend driver.
</span><span class="nx">localforage</span><span class="p">.</span><span class="na">setDriver</span> <span class="nx">localforage</span><span class="p">.</span><span class="na">LOCALSTORAGE</span>

<span class="c1"># Supply a list of drivers, in order of preference.
</span><span class="nx">localforage</span><span class="p">.</span><span class="na">setDriver</span> <span class="p">[</span><span class="nx">localforage</span><span class="p">.</span><span class="na">WEBSQL</span><span class="p">,</span> <span class="nx">localforage</span><span class="p">.</span><span class="na">INDEXEDDB</span><span class="p">]</span>
</code></pre>

<p><code class="prettyprint">setDriver(driverName)</code><br>
<code class="prettyprint">setDriver([driverName, nextDriverName])</code></p>

<p>Force usage of a particular driver or drivers, if available.</p>

<p>By default, localForage selects backend drivers for the datastore in this
order:</p>

<ol>
<li>IndexedDB</li>
<li>WebSQL</li>
<li>localStorage</li>
</ol>

<p>If you would like to force usage of a particular driver you can use
<code class="prettyprint">setDriver()</code> with one or more of the following parameters.</p>

<ul>
<li>localforage.INDEXEDDB</li>
<li>localforage.WEBSQL</li>
<li>localforage.LOCALSTORAGE</li>
</ul>

<p><aside class="notice">
  If the backend you&rsquo;re trying to load isn&rsquo;t available on the user&rsquo;s browser,
  localForage will continue to use whatever backend driver it was previously
  using. This means that if you try to force a Gecko browser to use WebSQL,
  it will fail and continue using IndexedDB.
</aside></p>

<h2 id="config">config</h2>
<pre class="highlight javascript"><code><span class="c1">// This will rename the database from "localforage"</span>
<span class="c1">// to "Hipster PDA App".</span>
<span class="nx">localforage</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="na">name</span><span class="p">:</span> <span class="s1">'Hipster PDA App'</span>
<span class="p">});</span>

<span class="c1">// This will force localStorage as the storage</span>
<span class="c1">// driver even if another is available. You can</span>
<span class="c1">// use this instead of `setDriver()`.</span>
<span class="nx">localforage</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="na">driver</span><span class="p">:</span> <span class="nx">localforage</span><span class="p">.</span><span class="nx">LOCALSTORAGE</span><span class="p">,</span>
    <span class="na">name</span><span class="p">:</span> <span class="s1">'I-heart-localStorage'</span>
<span class="p">});</span>

<span class="c1">// This will use a different driver order.</span>
<span class="nx">localforage</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="na">driver</span><span class="p">:</span> <span class="p">[</span><span class="nx">localforage</span><span class="p">.</span><span class="nx">WEBSQL</span><span class="p">,</span>
             <span class="nx">localforage</span><span class="p">.</span><span class="nx">INDEXEDDB</span><span class="p">,</span>
             <span class="nx">localforage</span><span class="p">.</span><span class="nx">LOCALSTORAGE</span><span class="p">],</span>
    <span class="na">name</span><span class="p">:</span> <span class="s1">'WebSQL-Rox'</span>
<span class="p">});</span>
</code></pre>
<pre class="highlight coffeescript"><code><span class="c1"># This will rename the database from "localforage"
# to "Hipster PDA App".
</span><span class="nx">localforage</span><span class="p">.</span><span class="na">config</span>
  <span class="na">name</span><span class="o">:</span> <span class="s">"Hipster PDA App"</span>


<span class="c1"># This will force localStorage as the storage
# driver even if another is available. You can
# use this instead of `setDriver()`.
</span><span class="nx">localforage</span><span class="p">.</span><span class="na">config</span>
  <span class="na">driver</span><span class="o">:</span> <span class="nx">localforage</span><span class="p">.</span><span class="na">LOCALSTORAGE</span>
  <span class="na">name</span><span class="o">:</span> <span class="s">"I-heart-localStorage"</span>

<span class="c1"># This will use a different driver order.
</span><span class="nx">localforage</span><span class="p">.</span><span class="na">config</span>
  <span class="na">driver</span><span class="o">:</span> <span class="p">[</span><span class="nx">localforage</span><span class="p">.</span><span class="na">WEBSQL</span><span class="p">,</span>
           <span class="nx">localforage</span><span class="p">.</span><span class="na">INDEXEDDB</span><span class="p">,</span>
           <span class="nx">localforage</span><span class="p">.</span><span class="na">LOCALSTORAGE</span><span class="p">]</span>
  <span class="na">name</span><span class="o">:</span> <span class="s">"WebSQL-Rox"</span>
</code></pre>

<p><code class="prettyprint">config(options)</code></p>

<p>Set and persist localForage options. This must be called <em>before</em> any other
calls to localForage are made, but can be called after localForage is loaded.
If you set any config values with this method they will persist after driver
changes, so you can call <code class="prettyprint">config()</code> then <code class="prettyprint">setDriver()</code>. The following config
values can be set:</p>

<dl>
  <dt>driver</dt>
  <dd>
    The preferred driver(s) to use. Same format as what is passed to `setDriver()`, above.<br>
    Default: <code>[localforage.INDEXEDDB, localforage.WEBSQL, localforage.LOCALSTORAGE]</code>
  </dd>
  <dt>name</dt>
  <dd>
    The name of the database. May appear during storage limit prompts.
    Useful to use the name of your app here. In localStorage, this is used as a
    key prefix for all keys stored in localStorage.<br>
    Default: <code>'localforage'</code>
  </dd>
  <dt>size</dt>
  <dd>
    The size of the database in bytes. Used only in WebSQL for now.<br>
    Default: <code>4980736</code>
  </dd>
  <dt>storeName</dt>
  <dd>
    The name of the datastore. In IndexedDB this is the
    <code>dataStore</code>, in WebSQL this is the name of the key/value
    table in the database. <strong>Must be alphanumeric,
    with underscores.</strong> Any non-alphanumeric characters will be converted
    to underscores.<br>
    Default: <code>'keyvaluepairs'</code>
  </dd>
  <dt>version</dt>
  <dd>
    The version of your database. May be used for upgrades in the future;
    currently unused.<br>
    Default: <code>1.0</code>
  </dd>
  <dt>description</dt>
  <dd>
    A description of the database, essentially for developer usage.<br>
    Default: <code>''</code>
  </dd>
</dl>

<p><aside class="notice">
  Unlike most of the localForage API, the <code>config</code> method is
  synchronous.
</aside></p>

<h1 id="custom-driver-api">Custom Driver API</h1>

<p>You can write your own, custom driver for localForage since <strong>version 1.1</strong>.</p>

<h2 id="definedriver">defineDriver</h2>
<pre class="highlight javascript"><code><span class="c1">// Implement the driver here.</span>
<span class="kd">var</span> <span class="nx">myCustomDriver</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">_driver</span><span class="p">:</span> <span class="s1">'customDriverUniqueName'</span><span class="p">,</span>
    <span class="na">_initStorage</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Custom implementation here...</span>
    <span class="p">},</span>
    <span class="na">clear</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Custom implementation here...</span>
    <span class="p">},</span>
    <span class="na">getItem</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Custom implementation here...</span>
    <span class="p">},</span>
    <span class="na">key</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Custom implementation here...</span>
    <span class="p">},</span>
    <span class="na">keys</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Custom implementation here...</span>
    <span class="p">},</span>
    <span class="na">length</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Custom implementation here...</span>
    <span class="p">},</span>
    <span class="na">removeItem</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Custom implementation here...</span>
    <span class="p">},</span>
    <span class="na">setItem</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Custom implementation here...</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Add the driver to localForage.</span>
<span class="nx">localforage</span><span class="p">.</span><span class="nx">defineDriver</span><span class="p">(</span><span class="nx">myCustomDriver</span><span class="p">);</span>
</code></pre>
<pre class="highlight coffeescript"><code><span class="c1"># Implement the driver here.
</span><span class="nx">myCustomDriver</span> <span class="o">=</span>
  <span class="na">_driver</span><span class="o">:</span> <span class="s">'customDriverUniqueName'</span>
  <span class="na">_initStorage</span><span class="o">:</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="c1"># Custom implementation here...
</span>  <span class="na">clear</span><span class="o">:</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="c1"># Custom implementation here...
</span>  <span class="na">getItem</span><span class="o">:</span> <span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="c1"># Custom implementation here...
</span>  <span class="na">key</span><span class="o">:</span> <span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="c1"># Custom implementation here...
</span>  <span class="na">keys</span><span class="o">:</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="c1"># Custom implementation here...
</span>  <span class="na">length</span><span class="o">:</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="c1"># Custom implementation here...
</span>  <span class="na">removeItem</span><span class="o">:</span> <span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="c1"># Custom implementation here...
</span>  <span class="na">setItem</span><span class="o">:</span> <span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="c1"># Custom implementation here...
</span>
<span class="c1"># Add the driver to localForage.
</span><span class="nx">localforage</span><span class="p">.</span><span class="na">defineDriver</span><span class="p">(</span><span class="nx">myCustomDriver</span><span class="p">)</span>
</code></pre>

<p>You&rsquo;ll want to make sure you accept a <code class="prettyprint">callback</code> argument and that you pass
the same arguments to callbacks as the default drivers do. You&rsquo;ll also want to
resolve or reject promises. Check any of the <a href="https://github.com/mozilla/localForage/tree/master/src/drivers">default drivers</a> for an idea
of how to implement your own, custom driver.</p>

<p>The custom implementation may contain a <code class="prettyprint">_support</code> property that is either
boolean (<code class="prettyprint">true</code>/<code class="prettyprint">false</code>) or returns a <code class="prettyprint">Promise</code> that resolves to a boolean
value. If <code class="prettyprint">_support</code> is omitted, then <code class="prettyprint">true</code> is the default value. You can
use this to make sure the browser in use supports your custom driver.</p>

<p><aside class="notice">
  These drivers are available to every instance of localForage on the page,
  regardless of which instance you use to add the implementation.
</aside></p>

        
      </div>
      <div class="dark-box">
        <div id="lang-selector">
          
            
              
                <a href="#" data-language-name="javascript">javascript</a>
              
            
              
                <a href="#" data-language-name="coffeescript">coffeescript</a>
              
            
          
        </div>
      </div>
    </div>
  </body>
</html>
